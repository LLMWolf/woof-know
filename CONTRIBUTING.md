# CONTRIBUTING.md — СПРИ

Спасибо за желание помочь проекту **СПРИ**! Ниже — минимальные правила вклада.

## 1. Как начать

1. Форкните репозиторий и создайте рабочую ветку от `main`:

   * Фича: `feat/<кратко>`
   * Баг: `fix/<кратко>`
   * Документация/опс: `docs/<кратко>` / `ops/<кратко>`
2. Ознакомьтесь с: `README.md`, `SECURITY.md`, `ARCH-СПРИ.md`, `openapi.yaml`, `settings.schema.json`.

## 2. Коммиты и PR

* Формат коммитов (желательно): **Conventional Commits** (`feat:`, `fix:`, `docs:`, `chore:`, `refactor:`, `test:`).
* PR должен содержать:

  * Описание изменения и мотивацию.
  * Ссылки на задачи/ADR (если есть).
  * Чек‑лист:

    * [ ] Обновлены/проверены схемы (`settings.schema.json`) и пример `settings.example.json`.
    * [ ] `openapi.yaml` валиден и проходит `spectral.yaml`.
    * [ ] Обновлена документация (README/ARCH/CHANGELOG), если влияет на поведение.
    * [ ] Безопасность: учтены политики из `SECURITY.md`.
    * [ ] Локальные тесты проходят.

## 3. Качество и линт

* OpenAPI: `make lint-openapi` (Spectral).
* Python: ruff/flake8 + mypy (при наличии типизации).
* JSON Schema: валидируйте примеры против `settings.schema.json` (AJV).

## 4. Тесты

* Минимум: smoke‑тесты (локально).
* По мере роста: unit + e2e.
* `kpi_smoke.py` можно запускать вручную перед PR.

## 5. Безопасность

* Не добавляйте секреты/токены в репозиторий.
* Следуйте STRIDE‑гайду из `SECURITY.md`.
* Внешние вызовы должны учитывать профили приватности и kill‑switch.

## 6. Миграции БД

* Стратегия **expand–migrate–contract**.
* Каждая миграция: отдельный файл с версией и `sha256`, запись в `schema_migrations`.

## 7. Версионирование и CHANGELOG

* SemVer: `MAJOR.MINOR.PATCH`.
* Каждое заметное изменение отражайте в `CHANGELOG.md`.

## 8. Лицензия

* Ваш вклад публикуется по лицензии проекта (см. `LICENSE`).

## 9. Связь

* Вопросы и обсуждения — через issues/PR. Безопасность — по инструкции в `SECURITY.md`.
